<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybtis.orh//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="kr.co.nextdoor.specifictask.dao.SpecificTaskDAO">
	<select id="listSpecifictask" resultType="kr.co.nextdoor.specifictask.dto.SpecificTaskDTO">
		select * from specifictask where task_no=#{task_no}
	</select>
	
		<!-- 파일업로드 -->
	<insert id="uploadFile">
		insert into file(specifictask_no, original_name, file_name, file_date, file_size)
		values(#{specifictask_no},#{original_name},#{file_name},now(),#{file_size})
	</insert>
	
	<!-- 수정완료버튼  -->
	 <update id="updateModiSpecifictask">
		update SpecificTaskModi set member_id=#{member_id}, 
		specifictask_start=#{specifictask_start}, 
		specifictask_end=#{specifictask_end}
		where specifictask_no=#{specifictask_no}
	</update>
	
	<!-- 수정값 불러오기 -->
	<select id="detailModiSpecifictask" resultType="kr.co.nextdoor.specifictask.dto.SpecificTaskModiDTO">
		select member_id,specifictask_start,specifictask_end from SpecificTaskModi
		where specifictask_no=#{specifictask_no}
	</select>
	
	<!-- 수정값 입력하기 -->
	<insert id="insertModiSpecifictask">
		insert into SpecificTaskModi(specifictask_no,member_id,specifictask_start,specifictask_end)
		values(#{specifictask_no},#{member_id},#{specifictask_start},#{specifictask_end})
	</insert>
	
	<!-- 세부업무삭제 -->
	<delete id="deleteSpecifictask">
		delete from specifictask where specifictask_no=#{specifictask_no}
	</delete>
	
	<!-- 상세업무 생성 -->
	<insert id="insertSpecifictask" parameterType="kr.co.nextdoor.specifictask.dto.SpecificTaskDTO">
		insert into specifictask(task_no, specifictask_cont, specifictask_comp) values(#{task_no}, #{specifictask_cont}, '0')
	</insert>
	
	<update id="checkSpecifcitask">
		update specifictask 
		<set>
			<if test="specifictask_comp == 0">specifictask_comp='1'</if>
			<if test="specifictask_comp == 1">specifictask_comp='0'</if>
		</set>
		 where specifictask_no = #{specifictask_no}
	</update>
	
	<select id="seleteSpecificTaskComp" resultType="kr.co.nextdoor.specifictask.dto.SpecificTaskDTO">
		select specifictask_comp from specifictask where specifictask_no=#{specifictask_no}
	</select>
	

	
</mapper>